{% extends 'adminbase.html' %}
{% block title %}Job Listings - Admin{% endblock %}

{% block content %}

<div class="min-h-screen bg-gray-50 p-4 sm:p-6">
    <div class="max-w-7xl mx-auto space-y-6">

        <!-- Header -->
        <div
            class="bg-white border rounded-2xl shadow-lg p-4 sm:p-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
            <div>
                <h1 class="text-2xl font-bold text-gray-900 uppercase">Job Listings</h1>
                <p class="text-sm text-gray-500">Manage all posted jobs</p>
            </div>

            <a href="{% url 'admin-jobpost' %}"
                class="inline-flex items-center gap-2 px-5 py-2 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-xl font-medium">
                <i data-lucide="plus-circle" class="w-5 h-5"></i>
                Post New Job
            </a>
        </div>


        {% if messages %}
        <div class="space-y-3">
            {% for message in messages %}
            <div
                class="flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-medium
                {% if message.tags == 'success' %}bg-green-100 text-green-700
                {% elif message.tags == 'error' %}bg-red-100 text-red-700
                {% else %}bg-blue-100 text-blue-700{% endif %}">
                <i data-lucide="{% if message.tags == 'success' %}check-circle{% else %}alert-circle{% endif %}"
                   class="w-4 h-4"></i>
                <span>{{ message }}</span>
                <button onclick="this.parentElement.remove()"
                        class="ml-auto text-gray-500 hover:text-gray-700">
                    &times;
                </button>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <!-- Job List -->
        <div class="space-y-4">

            {% for job in jobs %}
            <!-- Job Card -->
            <div class="bg-white border rounded-2xl shadow-sm p-4 sm:p-6 hover:shadow-md transition flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">

                <!-- Job Info -->
                <div class="flex-1 flex flex-col sm:flex-row sm:items-center sm:gap-4 w-full">
                    <div class="flex-shrink-0 mb-3 sm:mb-0">
                        <div class="w-12 h-12 sm:w-14 sm:h-14 bg-indigo-600 text-white font-bold rounded-xl flex items-center justify-center text-lg">
                            {{ job.company|slice:":1"|upper }}
                        </div>
                    </div>

                    <div class="flex-1">
                        <h3 class="text-lg sm:text-xl font-semibold text-gray-900">{{ job.title }}</h3>
                        <p class="text-sm text-gray-500">{{ job.company }}</p>
                        <p class="text-xs text-gray-400 mt-1">Posted {{ job.created_at|date:"d M Y" }}</p>

                        <div class="flex flex-wrap gap-2 mt-2 text-sm text-gray-600">
                            <span class="px-2 py-1 bg-gray-100 rounded-full">{{ job.category.name }}</span>
                            <span class="px-2 py-1 bg-gray-100 rounded-full">{{ job.location }}</span>
                            <span class="px-2 py-1 rounded-full
                                {% if job.job_type == 'remote' %}bg-green-100 text-green-700
                                {% elif job.job_type == 'hybrid' %}bg-blue-100 text-blue-700
                                {% else %}bg-purple-100 text-purple-700{% endif %}">
                                {{ job.get_job_type_display }}
                            </span>
                        </div>
                    </div>
                </div>

                <!-- Stats & Actions -->
                <div class="flex flex-col sm:items-end gap-2">
                    <p class="text-xs text-gray-500">
                        Vacancies: {{ job.vacancies }} Â· Applicants: {{ job.applications.count }}
                    </p>

                    <div class="flex gap-2 mt-2">
                        <!-- View -->
                        <a href="{% url 'admin-jobdetails' %}?id={{ job.id }}" title="View Job"
                            class="p-2 rounded-lg hover:bg-gray-100 transition">
                            <i data-lucide="eye" class="w-5 h-5 text-blue-600"></i>
                        </a>

                        <!-- Edit -->
                        <a href="{% url 'admin-jobedit' %}?id={{ job.id }}" title="Edit Job"
                            class="p-2 rounded-lg hover:bg-gray-100 transition">
                            <i data-lucide="edit-3" class="w-5 h-5 text-green-600"></i>
                        </a>

                        <!-- Delete -->
                        <a href="{% url 'admin-jobdelete' %}?id={{ job.id }}" title="Delete Job"
                            onclick="return confirm('Delete this job?');"
                            class="p-2 rounded-lg hover:bg-gray-100 transition">
                            <i data-lucide="trash-2" class="w-5 h-5 text-red-600"></i>
                        </a>
                    </div>
                </div>

            </div>
            {% empty %}
            <div class="px-6 py-10 text-center text-gray-500">
                No jobs posted yet.
            </div>
            {% endfor %}

        </div>

    </div>
</div>


{% endblock %}

{% extends 'cbase.html' %}
{% block content %}

<div class="max-w-6xl mx-auto px-4 sm:px-6 py-10">

    <!-- Back -->
    <a href="{% url 'candidate-joblist' %}"
        class="inline-flex items-center gap-2 text-sm text-gray-600 hover:text-blue-600 mb-6">
        <i data-lucide="arrow-left" class="w-4 h-4"></i>
        Back to Jobs
    </a>

    <!-- ================= HEADER ================= -->
    <div class="bg-gradient-to-r from-blue-50 to-white p-6 rounded-2xl shadow-sm border border-blue-100">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-6">

            <div>
                <h1 class="text-2xl md:text-3xl font-bold text-gray-900">
                    {{ job.title }}
                </h1>

                <div class="flex flex-wrap gap-4 text-sm text-gray-600 mt-3">
                    <span class="flex items-center gap-1">
                        <i data-lucide="building" class="w-4 h-4 text-blue-600"></i>
                        {{ job.company }}
                    </span>
                    <span class="flex items-center gap-1">
                        <i data-lucide="map-pin" class="w-4 h-4 text-blue-600"></i>
                        {{ job.location }}
                    </span>
                    <span class="flex items-center gap-1">
                        <i data-lucide="briefcase" class="w-4 h-4 text-blue-600"></i>
                        {{ job.get_job_type_display }}
                    </span>
                    <span class="flex items-center gap-1">
                        <i data-lucide="clock" class="w-4 h-4 text-blue-600"></i>
                        Posted {{ job.created_at|timesince }} ago
                    </span>
                </div>
            </div>

            {% if has_applied %}
            <button disabled
                class="px-8 py-3 bg-gray-300 text-gray-600 rounded-xl font-semibold cursor-not-allowed flex items-center gap-2">
                <i data-lucide="check-circle" class="w-5 h-5"></i>
                Applied
            </button>
            {% else %}
            <a href="{% url 'candidate-jobapply' job.id %}"
                class="px-8 py-3 bg-blue-600 text-white rounded-xl font-semibold hover:bg-blue-700 shadow-md flex items-center gap-2">
                <i data-lucide="send" class="w-5 h-5"></i>
                Apply Now
            </a>
            {% endif %}

        </div>
    </div>

    <!-- ================= CONTENT ================= -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mt-10">

        <!-- LEFT -->
        <div class="lg:col-span-2 space-y-8">

            <!-- Overview -->
            <div class="bg-white p-6 rounded-xl shadow border">
                <h2 class="text-lg font-semibold mb-3 flex items-center gap-2">
                    <i data-lucide="file-text" class="w-5 h-5 text-blue-600"></i>
                    Job Overview
                </h2>
                <p class="text-sm text-gray-700 leading-relaxed">
                    {{ job.short_description }}
                </p>
            </div>

            <!-- Description -->
            <div class="bg-white p-6 rounded-xl shadow border">
                <h2 class="text-lg font-semibold mb-3 flex items-center gap-2">
                    <i data-lucide="align-left" class="w-5 h-5 text-purple-600"></i>
                    Job Description
                </h2>
                <p class="text-sm text-gray-700 whitespace-pre-line leading-relaxed">
                    {{ job.description }}
                </p>
            </div>

            <!-- Requirements -->
            {% if job.requirements %}
            <div class="bg-white p-6 rounded-xl shadow border">
                <h2 class="text-lg font-semibold mb-3 flex items-center gap-2">
                    <i data-lucide="check-square" class="w-5 h-5 text-green-600"></i>
                    Requirements
                </h2>
                <p class="text-sm text-gray-700 whitespace-pre-line leading-relaxed">
                    {{ job.requirements }}
                </p>
            </div>
            {% endif %}
        </div>

        <!-- RIGHT SIDEBAR -->
        <aside class="space-y-6">

            <!-- Summary -->
            <div class="bg-white p-6 rounded-xl shadow border space-y-3 text-sm">
                <h3 class="font-semibold flex items-center gap-2 mb-3">
                    <i data-lucide="info" class="w-5 h-5 text-blue-600"></i>
                    Job Summary
                </h3>

                <p class="flex justify-between">
                    <span class="text-gray-600">Category</span>
                    <span class="font-medium">{{ job.category.name }}</span>
                </p>
                <p class="flex justify-between">
                    <span class="text-gray-600">Experience</span>
                    <span class="font-medium">{{ job.experience }}</span>
                </p>
                <p class="flex justify-between">
                    <span class="text-gray-600">Vacancies</span>
                    <span class="font-medium">{{ job.vacancies }}</span>
                </p>
            </div>

            <!-- Skills -->
            <div class="bg-white p-6 rounded-xl shadow border">
                <h3 class="font-semibold mb-3 flex items-center gap-2">
                    <i data-lucide="sparkles" class="w-5 h-5 text-yellow-500"></i>
                    Required Skills
                </h3>

                <div class="flex flex-wrap gap-2">
                    {% if job.skill_1 %}<span class="skill">{{ job.skill_1 }}</span>{% endif %}
                    {% if job.skill_2 %}<span class="skill">{{ job.skill_2 }}</span>{% endif %}
                    {% if job.skill_3 %}<span class="skill">{{ job.skill_3 }}</span>{% endif %}
                    {% if job.skill_4 %}<span class="skill">{{ job.skill_4 }}</span>{% endif %}
                    {% if job.skill_5 %}<span class="skill">{{ job.skill_5 }}</span>{% endif %}
                </div>
            </div>

            <!-- Apply Button -->
            {% if has_applied %}
            <button disabled
                class="w-full bg-gray-300 text-gray-600 py-3 rounded-xl font-semibold cursor-not-allowed flex justify-center gap-2">
                <i data-lucide="check-circle" class="w-5 h-5"></i>
                Applied
            </button>
            {% else %}
            <a href="{% url 'candidate-jobapply' job.id %}"
                class="block text-center bg-blue-600 text-white py-3 rounded-xl font-semibold hover:bg-blue-700 shadow-md flex justify-center gap-2">
                <i data-lucide="send" class="w-5 h-5"></i>
                Apply Now
            </a>
            {% endif %}

        </aside>
    </div>

</div>

<!-- STYLES -->
<style>
    .skill {
        background: #e0f2fe;
        color: #0369a1;
        padding: 6px 12px;
        border-radius: 9999px;
        font-size: 12px;
        font-weight: 500;
    }
</style>

<script>
    if (typeof lucide !== "undefined") {
        lucide.createIcons();
    }
</script>

{% endblock %}